(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e352bd8"],{"295a":function(t,e,a){"use strict";var s=a("f7a8"),i=a.n(s);i.a},"592f":function(t,e,a){"use strict";var s=a("d8e1"),i=a.n(s);i.a},"59d1":function(t,e,a){"use strict";var s=a("873e"),i=a.n(s);i.a},"873e":function(t,e,a){},d8e1:function(t,e,a){},e959:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:16}},[a("div",[a("a-button",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")]),a("label",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.detail.title)+"\n          "),a("a-popover",{attrs:{title:"当前状态"}},[a("template",{slot:"content"},[a("a-steps",{attrs:{size:"small",labelPlacement:"vertical",current:t.currentStatus}},[a("a-step",{attrs:{title:"未确认"}}),a("a-step",{attrs:{title:"已确认"}}),a("a-step",{attrs:{title:"处理中"}}),a("a-step",{attrs:{title:"已解决"}}),a("a-step",{attrs:{title:"已通过"}})],1)],1),a("span",{staticClass:"status-bug status-active",class:"status-bug_"+t.currentStatus,staticStyle:{"margin-left":"5px"}},[t._v(t._s(t.STATUS_CODES[t.currentStatus]||"未确认"))])],2)],1)],1),a("a-card",{staticStyle:{"margin-top":"10px"}},[a("h4",[t._v("描述")]),a("div",{staticClass:"describe-content",domProps:{innerHTML:t._s(t.decodedContent||"无")}}),a("HistoryList",{attrs:{list:t.history}}),t.detail.annex?a("div",[a("h4",[t._v("附件")]),a("div",[a("ul",t._l(t.detail.annexs,function(e){return e&&""!=e?a("li",{key:e},[a("a",{attrs:{href:e,target:"_blank"}},[t._v(t._s(t._f("fileName")(e)))])]):t._e()}),0)])]):t._e()],1),a("div",{staticClass:"main-actions"},[a("div",{staticClass:"btn-toolbar"},[[4==t.currentStatus&&t.isAdmin?a("a",{staticClass:"btn btn-link iframe",on:{click:function(e){return t.showModal(0)}}},[a("a-icon",{attrs:{type:"unlock"}}),a("span",{staticClass:"text"},[t._v("激活")])],1):t._e(),t.currentStatus?t._e():a("a",{staticClass:"btn btn-link iframe",on:{click:function(e){return t.showModal(1)}}},[a("a-icon",{attrs:{type:"eye"}}),a("span",{staticClass:"text"},[t._v("确认")])],1),1==t.currentStatus?a("a",{staticClass:"btn btn-link iframe",on:{click:function(e){return t.showModal(2)}}},[a("a-icon",{attrs:{type:"code"}}),a("span",{staticClass:"text"},[t._v("处理中")])],1):t._e(),2==t.currentStatus?a("a",{staticClass:"btn btn-link iframe",on:{click:function(e){return t.showModal(3)}}},[a("a-icon",{attrs:{type:"check"}}),a("span",{staticClass:"text"},[t._v("解决")])],1):t._e(),3==t.currentStatus?a("a",{staticClass:"btn btn-link iframe",on:{click:function(e){return t.showModal(4)}}},[a("a-icon",{attrs:{type:"smile"}}),a("span",{staticClass:"text"},[t._v("通过")])],1):t._e()]],2)])],1),a("a-col",{attrs:{span:8}},[a("div",{staticStyle:{"text-align":"right"}},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/bug/add")}}},[t._v("+提Bug")])],1),a("a-card",{staticStyle:{"margin-top":"10px"}},[a("table",{staticClass:"table table-data"},[a("tbody",[a("tr",{attrs:{valign:"middle"}},[a("th",{staticClass:"w-70px"},[t._v("所属项目")]),a("td",[t._v(t._s(t.detail.project))])]),a("tr",[a("th",[t._v("所属模块")]),a("td",{attrs:{title:"/"}},[t._v(t._s(t.detail.model))])]),a("tr",{attrs:{valign:"middle"}},[a("th",[t._v("Bug版本")]),a("td",[t._v(t._s(t.detail.edition))])]),a("tr",[a("th",[t._v("Bug类型")]),a("td",[t._v(t._s(t.detail.type))])]),a("tr",[a("th",[t._v("严重程度")]),a("td",[a("span",{staticClass:"severity_num",class:t.severityClass(t.detail.severity)},[t._v(t._s(t.BUG_VARIABLES.severity[t.detail.severity]))])])]),a("tr",[a("th",[t._v("优先级")]),a("td",[a("span",{staticClass:"priority_num",class:t.priorityClass(t.detail.priority)},[t._v(t._s(t.BUG_VARIABLES.priority[t.detail.priority]))])])]),a("tr",[a("th",[t._v("Bug状态")]),a("td",[a("span",{staticClass:"status-bug status-active",class:"status-bug_"+t.currentStatus},[t._v(t._s(t.STATUS_CODES[t.currentStatus]||"未确认"))])])]),a("tr",[a("th",[t._v("当前指派")]),a("td",[t._v(t._s(t.detail.leading&&t.detail.leading.name))])]),a("tr",[a("th",[t._v("抄送给")]),a("td",t._l(t.detail.sendMailUsers,function(e){return a("a-tag",[t._v(t._s(e.name))])}),1)]),a("tr",[a("th",[t._v("截止日期")]),a("td",[t._v("\n                "+t._s(t._f("dateTrim")(t.detail.settlingTime)))])])])])])],1)],1),a("status-modal",{ref:"modal",attrs:{history:t.history},on:{ok:t.onSetStatus}})],1)},i=[],n=(a("a481"),a("7f7f"),a("365c")),r=a("d9cd"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["description-list",t.size,"vertical"===t.layout?"vertical":"horizontal"]},[t.title?a("div",{staticClass:"title"},[t._v(t._s(t.title))]):t._e(),a("a-row",[t._t("default")],2)],1)},o=[],c=a("cebc"),d=(a("c5f6"),a("da05")),u={name:"DetailListItem",props:{term:{type:String,default:"",required:!1}},inject:{col:{type:Number}},render:function(){var t=arguments[0];return t(d["b"],{props:Object(c["a"])({},p[this.col])},[t("div",{class:"term"},[this.$props.term]),t("div",{class:"content"},[this.$slots.default])])}},p={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}},f={name:"DetailList",Item:u,components:{Col:d["b"]},props:{title:{type:String,default:"",required:!1},col:{type:Number,required:!1,default:3},size:{type:String,required:!1,default:"large"},layout:{type:String,required:!1,default:"horizontal"}},provide:function(){return{col:this.col>4?4:this.col}}},m=f,_=(a("295a"),a("2877")),v=Object(_["a"])(m,l,o,!1,null,"745c64a4",null),h=v.exports,g=h,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{staticStyle:{top:"20px"},attrs:{title:""+t.STATUS_ACTION_CODES[t.mdl.status],width:800},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"附件","label-col":{span:2},"wrapper-col":{span:12}}},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["annexs",{valuePropName:"fileList",getValueFromEvent:t.normFile}],expression:"[\n          'annexs', {\n            valuePropName: 'fileList',\n            getValueFromEvent: normFile,\n          }\n        ]"}],attrs:{withCredentials:!0,name:"file",extra:"文件最大限制10M","list-type":"text",beforeUpload:t.beforeUpload,action:t.uploadUrl},on:{change:t.handleChange}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),t._v(" 选择文件\n        ")],1)],1),a("div",[t._v("\n        附件文件类型： "),a("br"),t._v("\n        文档：doc docx xls xlsx ppt pptx pdf csv"),a("br"),t._v("\n        图片：bmp jpg png gif"),a("br"),t._v("\n        视频：3GP MP4 AVI\n      ")])],1),a("a-form-item",{attrs:{label:"描述","label-col":{span:2},"wrapper-col":{span:12}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["describe"],expression:"[\n          'describe'\n        ]"}],attrs:{placeholder:""}})],1)],1)],1)},x=[],y=a("a745"),S=a.n(y),C=(a("6762"),a("28a5"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"history-list"},[a("h4",[t._v("历史记录")]),a("ul",[a("li",[t._v("\n      "+t._s(t._f("dateTrim")(t.first.creatorTime))+", 由 "+t._s(t.first.creatorName)+" 创建。\n    ")]),t._l(t.others,function(e){return a("li",{key:e.id},[t._v("\n      "+t._s(t._f("dateTrim")(e.creatorTime))+", 由 "+t._s(e.creatorName)+" "+t._s(t.STATUS_ACTION_CODES[e.status])+"。 "),e.annex?a("a",{attrs:{href:t._f("staticUrl")(e.annex),target:"_blank"}},[t._v(t._s(e.annex.split("/")[1]))]):t._e(),a("div",{staticClass:"history-describe"},[e.describe?a("p",{domProps:{innerHTML:t._s(decodeURIComponent(e.describe))}}):t._e(),a("div",[a("ul",t._l(e.annexs,function(s){return s&&""!=s?a("li",{key:e},[a("a",{attrs:{href:s,target:"_blank"}},[t._v(t._s(t._f("fileName")(s)))])]):t._e()}),0)])])])})],2)])}),w=[],k={props:["list"],data:function(){return{STATUS_ACTION_CODES:r["c"],first:{},others:{}}},watch:{list:function(t){var e=[].concat(this.list);this.first=e.splice(0,1)[0],this.others=e}}},T=k,A=(a("59d1"),Object(_["a"])(T,C,w,!1,null,"16824eac",null)),O=A.exports,U={props:["history"],components:{HistoryList:O},data:function(){return{visible:!1,mdl:{},uploadUrl:"http://61.144.170.37:8085/upload",STATUS_ACTION_CODES:r["c"],form:this.$form.createForm(this)}},methods:{beforeUpload:function(t){var e=["doc","docx","xls","xlsx","ppt","pptx","pdf","csv","bmp","jpg","png","gif","3gp","mp4","avi"],a=t.name.split("."),s=a[a.length-1],i=e.includes(s);return i||this.$notification.error({message:"温馨提示",description:"附件上传限于以下文件类型： \n\n                  文档：doc docx xls xlsx ppt pptx pdf csv\n\n                  图片：bmp jpg png gif\n\n                  视频：3GP MP4 AVI\n"}),i},isValidFile:function(t){var e=["doc","docx","xls","xlsx","ppt","pptx","pdf","csv","bmp","jpg","png","gif","3gp","mp4","avi"],a=t.name.split("."),s=a[a.length-1],i=e.includes(s);return i},filterValidFile:function(t){var e=["doc","docx","xls","xlsx","ppt","pptx","pdf","csv","bmp","jpg","png","gif","3gp","mp4","avi"];return t.filter(function(t){var a=t.name.split("."),s=a[a.length-1],i=e.includes(s);return i})},handleChange:function(t){var e=t.fileList,a=(t.file,t.event,e.filter(this.isValidFile));console.log(a),this.form.setFieldsValue({annexs:a})},normFile:function(t){return S()(t)?this.filterValidFile(t):t&&this.filterValidFile(t.fileList)},reformatData:function(t){return t.describe=encodeURIComponent(t.describe),t.annexs&&t.annexs.length>0&&(t.annexs=t.annexs.map(function(t){return console.log(t),t.hasOwnProperty("response")?"http://".concat(window.localStorage.getItem("VUE_APP_HOST")?window.localStorage.getItem("VUE_APP_HOST"):"61.144.170.35",":").concat(window.localStorage.getItem("VUE_APP_PORT")?window.localStorage.getItem("VUE_APP_PORT"):"83","/download?path=").concat(t.response.data):t})),console.log(t),t},show:function(t){var e=this,a=t.id,s=t.status;this.visible=!0,this.mdl={id:a,status:s},this.$nextTick(function(){e.form.resetFields()})},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var t=this;this.form.validateFields(function(e,a){if(!e){t.confirmLoading=!0;var s=t.reformatData(a);n["default"].bug.setStatus(Object(c["a"])({},t.mdl,s)).then(function(e){t.$message.success("保存成功"),t.$emit("ok")}).catch(function(){}).finally(function(){t.confirmLoading=!1,t.close()})}})}}},I=U,E=Object(_["a"])(I,b,x,!1,null,null,null),P=E.exports,$=g.Item,L={components:{DescriptionList:g,DescriptionListItem:$,StatusModal:P,HistoryList:O},data:function(){return{detail:{},history:[],id:this.$route.params.id,BUG_VARIABLES:r["a"],STATUS_CODES:r["d"]}},created:function(){this.getDetail(),this.getHistory()},computed:{currentStatus:function(){return this.detail.status},decodedContent:function(){return decodeURIComponent(this.detail.describe)},isAdmin:function(){return"admin"===this.$store.getters.userInfo.name}},methods:{priorityClass:function(t){var e={};return e["priority_num_".concat(5-t)]=!0,e},severityClass:function(t){var e={};return e["severity_num_".concat(6-t)]=!0,e},handleDelete:function(t){var e=this;this.$confirm({title:"温馨提示",content:"您确定要删除该Bug吗？删除后无法恢复",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){e.$router.replace("/dashboard/workplace")},onCancel:function(){console.log("Cancel")}})},getDetail:function(){var t=this;n["default"].bug.detail(this.id).then(function(e){t.detail=e.data})},getHistory:function(){var t=this;n["default"].bug.history(this.id).then(function(e){t.history=e.result.data})},showModal:function(t){this.$refs.modal.show({status:t,id:this.id})},onSetStatus:function(t){this.getDetail(),this.getHistory()}}},D=L,V=(a("592f"),Object(_["a"])(D,s,i,!1,null,null,null));e["default"]=V.exports},f7a8:function(t,e,a){}}]);