(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e5a81f0"],{"219e":function(t,e,n){},3759:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-card",[n("h2",[t._v(t._s(t.$route.query.title)+"-权限设置")]),n("a-spin",{attrs:{spinning:t.spinning}},[n("table",{staticClass:"table table-hover table-striped table-bordered",attrs:{width:"100%"}},[n("thead",[n("tr",[n("th",{staticClass:"w-150px"},[t._v("模块(页面显示)")]),n("th",[t._v("方法")])])]),n("tbody",t._l(t.permissions,function(e){return n("tr",[n("td",[n("a-checkbox",{attrs:{value:e.action,checked:t.isDefaultChecked(e.action)},on:{change:function(n){return t.onCheckAllChange(n,e)}}},[t._v(t._s(e.name))])],1),n("td",[n("a-checkbox-group",{staticStyle:{width:"100%"},attrs:{defaultValue:t.checkedObj[e.action]["actionEntitySet"]},on:{change:function(n){return t.onChange(n,e)}}},[n("a-row",t._l(e.actionEntitySet,function(e){return n("a-col",{attrs:{span:4}},[n("a-checkbox",{attrs:{value:e.action}},[t._v(t._s(e.name))])],1)}),1)],1)],1)])}),0)]),n("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[n("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.savePermission}},[t._v("保存")]),n("a-button",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")])],1)])],1)},a=[],c=(n("a481"),n("db0c")),s=n.n(c),r=(n("20d6"),n("7f7f"),n("7514"),n("ac6a"),n("c5f6"),n("55dd"),n("795b")),o=n.n(r),u=(n("6762"),n("2fdb"),n("96cf"),n("3b8d")),h=n("365c"),d={data:function(){return{permissions:[],checkedObj:{},indeterminate:!0,checkAll:{},pageChecked:[],myPermissions:[],spinning:!0}},created:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getRoleInfo();case 2:return t.next=4,this.getPermissions();case 4:this.makeChecked(),this.spinning=!1;case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{isDefaultChecked:function(t){return this.pageChecked.includes(t)},getRoleInfo:function(){var t=this;return new o.a(function(e){h["default"].role.getRole(t.$route.params.id).then(function(n){t.myPermissions=n.data.permissions||[],e()})})},getPermissions:function(){var t=this;return new o.a(function(e){h["default"].permission.list().then(function(n){t.permissions=n.result.data.sort(function(t,e){return Number(t.id)-Number(e.id)}),t.permissions.forEach(function(e){var n=[],i=t.myPermissions.find(function(t){return t.action===e.action});i&&(n=i.actionEntitySet),t.checkedObj[e.action]={name:e.name,action:e.action,actionEntitySet:n}}),e()})})},makeChecked:function(){this.pageChecked=this.myPermissions.map(function(t){return t.action})},onChange:function(t,e){this.$set(this.checkedObj[e.action],"actionEntitySet",t)},onCheckAllChange:function(t,e){if(t.target.checked)this.pageChecked.push(e.action);else{var n=this.pageChecked.findIndex(function(t){return t===e.action});this.pageChecked.splice(n,1)}},savePermission:function(){var t=this,e=s()(this.checkedObj),n=[];e.forEach(function(e){t.pageChecked.includes(e.action)&&n.push(e)}),h["default"].permission.saveRolePermissions(this.$route.params.id,n).then(function(e){e.success&&(t.$message.success("保存成功"),setTimeout(function(){t.$router.replace("/"),setTimeout(function(){window.location.reload()})},1e3))})}}},f=d,l=(n("da98"),n("2877")),p=Object(l["a"])(f,i,a,!1,null,"f74c40c0",null);e["default"]=p.exports},da98:function(t,e,n){"use strict";var i=n("219e"),a=n.n(i);a.a}}]);