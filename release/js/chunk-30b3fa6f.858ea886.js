(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30b3fa6f"],{5014:function(e,t,a){},"62c7":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"choose-user-input"},[a("div",{staticClass:"choose-user-tags"},e._l(e.tags,function(t,r){return a("a-tag",{key:t.account,attrs:{closable:""},on:{close:function(t){return e.deleteTag(r)}}},[e._v(e._s(t.name))])}),1),a("a-button",{attrs:{type:"primary"},on:{click:function(t){e.visible=!0}}},[e._v("选择用户")]),a("a-modal",{staticStyle:{top:"20px"},attrs:{title:e.title,width:600},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"}},[a("a-transfer",{attrs:{dataSource:e.userList,showSearch:"",filterOption:e.filterOption,targetKeys:e.targetKeys,render:e.renderItem},on:{change:e.handleChange,selectChange:e.handleSelectChange}})],1)])],1)},n=[],i=(a("6762"),a("2fdb"),a("7f7f"),a("a745")),s=a.n(i);function o(e){if(s()(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}var l=a("774e"),c=a.n(l),u=a("c8bb"),d=a.n(u);function p(e){if(d()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return c()(e)}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(e){return o(e)||p(e)||m()}var v=a("365c"),h={props:{title:String,value:{type:Array,default:function(){return[]}},isSingle:{type:Boolean,default:function(){return!0}}},data:function(){return{userList:[],targetKeys:[],visible:!1,tags:[]}},watch:{value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.targetKeys=e},targetKeys:function(e,t){this.isSingle&&e.length>1&&(this.$message.error("只能指派一个用户"),e.pop())}},created:function(){this.getUsers()},methods:{deleteTag:function(e){this.tags.splice(e,1),this.triggerChange(this.tags)},handleChange:function(e,t,a){this.targetKeys=e},handleSelectChange:function(e,t){this.selectedKeys=[].concat(f(e),f(t))},getUsers:function(e){var t=this;v["default"].user.list({pageNo:1,pageSize:-1,keyword:e}).then(function(e){t.userList=e.result.data.map(function(e){return e.key=e.id,e.title=e.name,e.description=e.position,e.chosen=!1,e})})},show:function(e){this.title=e,this.visible=!0},renderItem:function(e){var t=this.$createElement,a=t("span",{class:"custom-item"},[e.name]);return{label:a,value:e.name}},close:function(){this.visible=!1},handleOk:function(){var e=this,t=this.userList.filter(function(t){return e.targetKeys.includes(t.id)});this.tags=t,this.close(),this.triggerChange(t)},filterOption:function(e,t){return t.name.indexOf(e)>-1},triggerChange:function(e){this.$emit("change",e)}}},g=h,b=(a("a34b"),a("2877")),y=Object(b["a"])(g,r,n,!1,null,null,null);t["a"]=y.exports},"62f6":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{top:"20px"},attrs:{title:"新增"+e.typeText,width:800},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form",{attrs:{form:e.form,id:"userForm"}},[a("a-form-item",{attrs:{label:e.typeText+"名称",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入"+e.typeText+"名称"}]}],expression:"[\n          'name',\n          {rules: [{ required: true, message: `请输入${typeText}名称` }]}\n        ]"}],attrs:{placeholder:""}})],1)],1)],1)},n=[],i=(a("7f7f"),a("365c")),s={data:function(){return{visible:!1,type:1,form:this.$form.createForm(this)}},computed:{typeText:function(){var e="";switch(this.type){case 1:e="项目";break;case 2:e="模块";break;case 3:e="版本";break}return e}},methods:{add:function(e){var t=this;this.visible=!0,this.type=e,this.$nextTick(function(){t.form.resetFields()})},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this;this.form.validateFields(function(t,a){t||(e.confirmLoading=!0,i["default"].system.addSystemClassfication(e.type,a.name).then(function(t){e.$message.success("保存成功"),e.$emit("ok",e.type,a.name)}).catch(function(){}).finally(function(){e.confirmLoading=!1,e.close()}))})}}},o=s,l=a("2877"),c=Object(l["a"])(o,r,n,!1,null,null,null);t["a"]=c.exports},6439:function(e,t,a){},"6af3":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",{attrs:{title:"提Bug"}},[a("a-form",{staticClass:"ant-advanced-search-form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:24}},[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"Bug标题"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"请输入Bug标题"}]}],expression:"[\n                    `title`,\n                    {\n                      rules: [{\n                        required: true,\n                        message: '请输入Bug标题',\n                      }],\n                    }\n                  ]"}],attrs:{placeholder:""}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-item",[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%","border-radius":"0","text-align":"center"},attrs:{defaultValue:"严重程度",disabled:""}}),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["severity",{rules:[{required:!0,message:"请选择严重程度"}]}],expression:"[\n                      `severity`,\n                      {\n                        rules: [{\n                          required: true,\n                          message: '请选择严重程度',\n                        }],\n                      }\n                    ]"}],staticStyle:{width:"60%","border-left":"none","border-radius":"0"}},e._l(e.BUG_VARIABLES.severity,function(t,r){return a("a-select-option",{key:t,attrs:{value:r}},[e._v(e._s(t))])}),1)],1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-item",[a("a-input-group",{attrs:{compact:""}},[a("a-input",{staticStyle:{width:"40%","border-radius":"0","text-align":"center"},attrs:{defaultValue:"优先级",disabled:""}}),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["priority",{rules:[{required:!0,message:"请选择优先级"}]}],expression:"[\n                      `priority`,\n                      {\n                        rules: [{\n                          required: true,\n                          message: '请选择优先级',\n                        }],\n                      }\n                    ]"}],staticStyle:{width:"60%","border-left":"none","border-radius":"0"}},e._l(e.BUG_VARIABLES.priority,function(t,r){return a("a-select-option",{key:t,attrs:{value:r}},[e._v(e._s(t))])}),1)],1)],1)],1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属项目"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["project",{rules:[{required:!0,message:"请选择所属项目"}]}],expression:"[\n                `project`,\n                {\n                  rules: [{\n                    required: true,\n                    message: '请选择所属项目',\n                  }],\n                }\n              ]"}],attrs:{showSearch:"",allowClear:"",filterOption:e.filterOption,placeholder:""},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return a("div",{},[a("div",{staticStyle:{padding:"8px",cursor:"pointer",position:"relative"},on:{mousedown:function(t){return e.$refs.modal.add(1)}}},[a("a-icon",{attrs:{type:"plus"}}),e._v(" 添加新项目\n                ")],1),a("a-divider",{staticStyle:{margin:"4px 0"}}),a("v-nodes",{attrs:{vnodes:t}})],1)}}])},e._l(e.projectList,function(t){return a("a-select-option",{key:t.id,attrs:{value:t.name}},[e._v(e._s(t.name))])}),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属模块"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["model"],expression:"[\n                `model`\n              ]"}],attrs:{showSearch:"",filterOption:e.filterOption,placeholder:""},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return a("div",{},[a("div",{staticStyle:{padding:"8px",cursor:"pointer",position:"relative"},on:{mousedown:function(t){return e.$refs.modal.add(2)}}},[a("a-icon",{attrs:{type:"plus"}}),e._v(" 添加新模块\n                ")],1),a("a-divider",{staticStyle:{margin:"4px 0"}}),a("v-nodes",{attrs:{vnodes:t}})],1)}}])},e._l(e.modelList,function(t){return a("a-select-option",{key:t.id,attrs:{value:t.name}},[e._v(e._s(t.name))])}),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"影响版本"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["edition",{rules:[{required:!0,message:"请选择影响版本"}]}],expression:"[\n                `edition`,\n                {\n                  rules: [{\n                    required: true,\n                    message: '请选择影响版本',\n                  }],\n                }\n              ]"}],attrs:{showSearch:"",filterOption:e.filterOption,placeholder:""},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return a("div",{},[a("div",{staticStyle:{padding:"8px",cursor:"pointer",position:"relative"},on:{mousedown:function(t){return e.$refs.modal.add(3)}}},[a("a-icon",{attrs:{type:"plus"}}),e._v(" 添加新版本\n                ")],1),a("a-divider",{staticStyle:{margin:"4px 0"}}),a("v-nodes",{attrs:{vnodes:t}})],1)}}])},e._l(e.editionList,function(t){return a("a-select-option",{key:t.id,attrs:{value:t.name}},[e._v(e._s(t.name))])}),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"bug类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"请选择bug类型"}]}],expression:"[\n                `type`,\n                {\n                  rules: [{\n                    required: true,\n                    message: '请选择bug类型',\n                  }],\n                }\n              ]"}],attrs:{showSearch:"",filterOption:e.filterOption,placeholder:""}},e._l(e.BUG_VARIABLES.type,function(t){return a("a-select-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"当前指派"}},[a("FormChooseUser",{directives:[{name:"decorator",rawName:"v-decorator",value:["leading_id",{rules:[{required:!0,message:"请选择要指派的用户"}]}],expression:"[\n                `leading_id`,\n                {\n                  rules: [{\n                    required: true,\n                    message: '请选择要指派的用户',\n                  }],\n                }\n              ]"}],attrs:{title:"当前指派","is-single":!0,placeholder:""}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"抄送给"}},[a("FormChooseUser",{directives:[{name:"decorator",rawName:"v-decorator",value:["sendMails"],expression:"[\n                `sendMails`\n              ]"}],attrs:{title:"抄送给","is-single":!1,placeholder:""}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"开始日期"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["start_time",{rules:[{required:!0,message:"请选择开始日期"}]}],expression:"[\n                `start_time`,\n                {\n                  rules: [{\n                    required: true,\n                    message: '请选择开始日期',\n                  }],\n                }\n              ]"}],staticStyle:{width:"100%"},attrs:{placeholder:""}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"截止日期"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["settling_time",{rules:[{required:!0,message:"请选择截止日期"}]}],expression:"[\n                `settling_time`,\n                {\n                  rules: [{\n                    required: true,\n                    message: '请选择截止日期',\n                  }],\n                }\n              ]"}],staticStyle:{width:"100%"},attrs:{placeholder:""}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"硬件平台"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["hardware_platform",{initialValue:"all"}],expression:"[\n                `hardware_platform`,\n                {\n                  initialValue: 'all'\n                }\n              ]"}],attrs:{showSearch:"",filterOption:e.filterOption,placeholder:""}},e._l(e.BUG_VARIABLES.hardware_platform,function(t){return a("a-select-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"操作系统"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["operating_system",{initialValue:"all"}],expression:"[\n                `operating_system`,\n                {\n                  initialValue: 'all'\n                }\n              ]"}],attrs:{showSearch:"",filterOption:e.filterOption,placeholder:""}},e._l(e.BUG_VARIABLES.operating_system,function(t){return a("a-select-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"浏览器"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["browser",{initialValue:"全部"}],expression:"[\n                `browser`,\n                {\n                  initialValue: '全部'\n                }\n              ]"}],attrs:{showSearch:"",filterOption:e.filterOption,placeholder:""}},e._l(e.BUG_VARIABLES.browser,function(t){return a("a-select-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["describe"],expression:"[\n                `describe`\n              ]"}],attrs:{autosize:{minRows:6,maxRows:6},placeholder:""}})],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"附件"}},[a("div",{staticStyle:{width:"300px"}},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["annex",{valuePropName:"fileList",getValueFromEvent:e.normFile}],expression:"['annex', {\n                valuePropName: 'fileList',\n                getValueFromEvent: normFile,\n              }]"}],attrs:{name:"file",extra:"文件最大限制10M","list-type":"picture",action:e.uploadUrl}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 选择文件\n                ")],1)],1)],1)])],1),a("a-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary","html-type":"submit",loading:e.loading}},[e._v("\n            保存\n          ")]),a("a-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("\n            取消\n          ")])],1)],1)],1)],1),a("type-modal",{ref:"modal",on:{ok:e.onAddedType}})],1)},n=[],i=a("a745"),s=a.n(i),o=(a("a481"),a("795b")),l=a.n(o),c=(a("ac6a"),a("5df3"),a("cadf"),a("551c"),a("f751"),a("097d"),a("d9cd")),u=a("62f6"),d=a("62c7"),p=a("365c"),m={components:{TypeModal:u["a"],FormChooseUser:d["a"],VNodes:{functional:!0,render:function(e,t){return t.props.vnodes}}},data:function(){return{uploadUrl:"http://61.144.170.37:8085/upload",labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},BUG_VARIABLES:c["a"],projectList:[],modelList:[],editionList:[],loading:!1,leading:[],sendMails:[],modalType:1,form:this.$form.createForm(this)}},created:function(){var e=this;l.a.all([1,2,3].map(function(e){return p["default"].system.getSystemClassfication(e)})).then(function(t){e.projectList=t[0],e.modelList=t[1],e.editionList=t[2]})},methods:{handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,a){if(!e){var r=t.reformatData(a);t.loading=!0,p["default"].bug.save(r).then(function(e){t.$message.success("保存成功"),t.loading=!1,t.$router.replace("/bug/dashboard")}).catch(function(){t.loading=!1})}})},reformatData:function(e){return e.settling_time=e.settling_time.toDate(),e.leading_id=e.leading_id[0].id,e.sendMails&&(e.sendMails=e.sendMails.map(function(e){return e.id}).join(",")),e.annex&&(e.annex=e.annex[0].response.data),e},normFile:function(e){return console.log("Upload event:",e),s()(e)?e:e&&e.fileList},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},onAddedType:function(e,t){var a=this;p["default"].system.getSystemClassfication(e).then(function(r){var n={1:"projectList",2:"modelList",3:"editionList"};a[n[e]]=r;var i=n[e].replace(/List/,""),s={};s[i]=t,a.form.setFieldsValue(s)})},onChoosedUers:function(e){this.leading=e},onChoosedSendMails:function(e){this.sendMails=e},deleteUser:function(e,t){this[e].splice(t,1)},onDeleteLeading:function(){}}},f=m,v=(a("cca2"),a("2877")),h=Object(v["a"])(f,r,n,!1,null,null,null);t["default"]=h.exports},"774e":function(e,t,a){e.exports=a("d2d5")},a34b:function(e,t,a){"use strict";var r=a("5014"),n=a.n(r);n.a},c8bb:function(e,t,a){e.exports=a("54a1")},cca2:function(e,t,a){"use strict";var r=a("6439"),n=a.n(r);n.a}}]);